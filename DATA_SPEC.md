# データ仕様書

このドキュメントは、漢字書き取りアプリの問題データの仕様と追加方法を説明します。

## ファイル構成

```
public/data/
├── grade1.csv   # 1年生の問題
├── grade2.csv   # 2年生の問題
├── grade3.csv   # 3年生の問題
├── grade4.csv   # 4年生の問題
├── grade5.csv   # 5年生の問題
└── grade6.csv   # 6年生の問題
```

## CSV形式

各CSVファイルは以下の形式で問題を定義します：

```
[読み仮名]文脈,漢字
```

### 列の説明

| 列 | 説明 | 例 |
|----|------|-----|
| 1 | 問題文（`[]`で読みを囲む） | `[にち]ようび` |
| 2 | 正解の漢字 | `日` |

### 形式の詳細

- **読み仮名**: `[]`（角括弧）で囲んだ部分が読み仮名として表示されます
- **文脈**: 括弧の前後の文字は文脈として表示されます
- **漢字**: 2列目が正解として判定される漢字です

### 例

```csv
[にち]ようび,日
[か]ようび,火
[みず]をのむ,水
[き]のした,木
[やま]にのぼる,山
```

表示例:
- `[にち]ようび` → 「**にち**ようび」と表示され、「日」を書くと正解

## 問題の追加方法

### 1. CSVファイルを開く

対象学年のファイル（例: `public/data/grade1.csv`）をテキストエディタで開きます。

### 2. 新しい行を追加

```csv
[あたら]しい,新
[くるま]にのる,車
```

### 3. 注意事項

- **UTF-8で保存**: 日本語が正しく表示されるよう、必ずUTF-8で保存してください
- **括弧は必須**: `[]`で読み仮名を囲まないとエラーになります
- **コメント**: `#`で始まる行はコメントとして無視されます
- **空行**: 空行は自動的にスキップされます

### 形式のパターン

```csv
# 読みが先頭の場合
[もり]のなか,森

# 読みが中間の場合
いい[てん]き,天

# 読みだけの場合
[そら],空
```

## 漢字認識について

このアプリはTensorFlow.jsを使った手書き認識AIを使用しています。

- **上位5候補**に正解の漢字が含まれていれば正解と判定
- 書き順は問いません（形が認識できればOK）
- 約3000字の漢字を認識可能

## トラブルシューティング

### 問題が表示されない

- CSVの形式が正しいか確認
- `[]`で読み仮名を囲んでいるか確認
- ファイルがUTF-8で保存されているか確認

### 特定の漢字が認識されない

- 一部の旧字体や特殊な漢字は認識モデルに含まれていない可能性があります
- 小学校で習う教育漢字（約1000字）は基本的にすべて対応しています
